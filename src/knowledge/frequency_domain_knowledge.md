# 주파수 분석 도메인 지식
**Frequency Domain Analysis for AI-Generated Image Detection**

---

## 📚 과학적 근거

### 핵심 논문
1. **"CNN-generated images are surprisingly easy to spot... for now" (Wang et al., 2020)**
   - GAN 생성 이미지는 주파수 도메인에서 특징적 패턴을 보임
   - 업샘플링 과정에서 발생하는 격자 아티팩트

2. **"On the detection of synthetic images generated by diffusion models" (Corvi et al., 2023)**
   - Diffusion 모델은 고주파 손실 특성
   - 자연 이미지와 다른 주파수 분포

3. **"Do GANs leave specific frequency signatures?" (Dzanic et al., 2020)**
   - GAN별 고유한 주파수 서명
   - 8x8, 16x16 주기성 패턴

---

## 🔬 분석 원리

### 1. FFT (Fast Fourier Transform) 분석
```
공간 도메인 이미지 → FFT → 주파수 도메인
```

**의미**:
- 이미지의 주파수 성분 분해
- 저주파: 전반적인 구조, 색상
- 고주파: 세부 디테일, 엣지

### 2. GAN 아티팩트의 원인
```
GAN Generator:
  Latent Vector (z)
    → FC Layer
    → Deconv/Upsampling Layers
    → Generated Image
```

**업샘플링 과정에서 발생하는 문제**:
- Nearest Neighbor Upsampling → 격자 패턴
- Transposed Convolution → 체커보드 아티팩트
- 주파수 도메인에서 주기적 피크로 나타남

**과학적 설명**:
- 업샘플링은 정보를 "추정"하는 과정
- 이 과정에서 특정 주파수 대역에 인위적 패턴 생성
- 자연 이미지는 이런 규칙적 패턴이 없음

---

## 📊 메트릭 해석 가이드

### 1. grid_pattern_score (격자 패턴 점수)
**측정 방법**: FFT 스펙트럼에서 주기적 피크 탐지

| 범위 | 의미 | 과학적 근거 |
|------|------|------------|
| 0.7 - 1.0 | 강한 격자 패턴 | GAN 생성 확실. ProGAN, StyleGAN 계열에서 흔함 |
| 0.4 - 0.7 | 중간 격자 패턴 | GAN 후처리 또는 JPEG 압축 효과 가능 |
| 0.0 - 0.4 | 격자 패턴 없음 | 자연 이미지 또는 최신 Diffusion 모델 |

**왜 GAN만 격자 패턴을 보이는가?**
- Diffusion 모델은 iterative denoising → 격자 패턴 없음
- Autoregressive 모델은 순차 생성 → 격자 패턴 없음
- GAN만 upsampling 기반 → 격자 패턴 발생

### 2. periodic_artifacts (주기적 아티팩트)
**측정 방법**: 8x8, 16x16 주기성 탐지

**의미**:
- `True`: GAN의 Deconv 레이어 영향
- `False`: 자연스러운 주파수 분포

**관련 GAN 아키텍처**:
- DCGAN: 4x4 → 8x8 → 16x16 → ... (2배씩 증가)
- ProGAN: Progressive Growing → 각 단계별 아티팩트
- StyleGAN: AdaIN → 약한 아티팩트 (하지만 여전히 존재)

### 3. hf_lf_ratio (고주파/저주파 비율)
**측정 방법**: High Frequency Energy / Low Frequency Energy

| 범위 | 의미 | 원인 |
|------|------|------|
| > 1.5 | 고주파 과다 | 과도한 샤프닝, 조작 가능성 |
| 0.8 - 1.5 | 정상 범위 | 자연 이미지 |
| < 0.8 | 고주파 부족 | Diffusion 모델 또는 블러링 |

**Diffusion 모델의 특징**:
- DDPM, Stable Diffusion → 고주파 손실
- Denoising 과정이 고주파를 smoothing
- 결과: 약간 부드러운 이미지

---

## ⚖️ 분석의 강점과 한계

### 강점
✅ **GAN 탐지에 매우 효과적**
   - 격자 패턴은 GAN의 명확한 지문
   - 휴먼 아이는 못 보지만 FFT는 탐지 가능

✅ **압축에 강건함**
   - JPEG 압축 후에도 격자 패턴 일부 보존
   - PNG 변환 시 완벽 보존

✅ **빠른 분석**
   - FFT는 O(n log n) 복잡도
   - 실시간 분석 가능

### 한계
❌ **최신 Diffusion 모델 탐지 어려움**
   - Stable Diffusion, DALL-E 3 등은 격자 패턴 없음
   - 고주파 손실로만 간접 추론 가능

❌ **후처리에 취약**
   - 강한 블러링 → 격자 패턴 소멸
   - 리사이징 → 패턴 왜곡 가능

❌ **자연 이미지의 오탐**
   - 디지털 카메라의 Bayer 패턴 → 약한 주기성
   - JPEG 압축 아티팩트 → 8x8 블록 패턴

---

## 🤝 다른 분석과의 관계

### vs Noise Analysis (PRNU)
- **보완 관계**: 주파수는 생성 패턴, PRNU는 센서 흔적
- **상충 가능성**:
  - 주파수: AI_GENERATED (격자 패턴)
  - PRNU: AUTHENTIC (센서 노이즈 존재)
  - → 실제 사진에 GAN으로 객체 추가한 경우

### vs Watermark Detection
- **독립적**: 주파수 분석은 생성 방법, 워터마크는 출처 정보
- **함께 사용**:
  - Stable Diffusion 워터마크 + 고주파 손실 → AI 생성 확실

### vs Spatial Analysis
- **보완 관계**:
  - 주파수: 전역 패턴 (global frequency signature)
  - 공간: 지역 불일치 (local inconsistency)
- **함께 사용**: 더 높은 신뢰도

---

## 💡 해석 예시

### Case 1: 명확한 GAN 생성
```
grid_pattern_score: 0.82
periodic_artifacts: True
hf_lf_ratio: 1.1
```

**해석**:
"강한 격자 패턴(0.82)과 주기적 아티팩트가 탐지되었습니다.
이는 ProGAN 또는 StyleGAN 계열 GAN의 전형적인 특징입니다.
업샘플링 레이어에서 발생한 8x8 주기성이 FFT 스펙트럼에서
명확한 피크로 나타납니다. AI 생성 이미지로 판단합니다."

### Case 2: Diffusion 모델 의심
```
grid_pattern_score: 0.15
periodic_artifacts: False
hf_lf_ratio: 0.72
```

**해석**:
"격자 패턴은 없지만 고주파/저주파 비율이 낮습니다(0.72).
이는 Diffusion 모델의 denoising 과정에서 고주파가 손실된
특징과 일치합니다. Stable Diffusion 또는 최신 생성 모델 가능성이
있으나, 단순 블러링일 수도 있어 다른 분석 결과가 필요합니다."

### Case 3: 자연 이미지
```
grid_pattern_score: 0.08
periodic_artifacts: False
hf_lf_ratio: 1.15
```

**해석**:
"격자 패턴 없음, 정상적인 주파수 분포를 보입니다.
자연스러운 고주파 성분이 존재하며, 인위적인 주기성이
발견되지 않았습니다. 실제 카메라로 촬영한 이미지일 가능성이 높습니다."

---

## 📖 참고문헌

1. Wang et al., "CNN-generated images are surprisingly easy to spot... for now", CVPR 2020
2. Dzanic et al., "Fourier spectrum discrepancies in deep network generated images", NeurIPS 2020
3. Corvi et al., "Detection of Diffusion Model Generated Images", IEEE Access 2023
4. Frank et al., "Leveraging Frequency Analysis for Deep Fake Image Recognition", ICML 2020

---

**주의**: 이 지식은 2023년까지의 연구 기반.
최신 생성 모델은 이러한 탐지를 우회할 수 있음.
