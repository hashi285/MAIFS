# 워터마크 탐지 도메인 지식
**HiNet 기반 워터마크/스테가노그래피 복원**

---

## 📚 과학적 근거

### 핵심 논문
1. **"HiNet: Deep Image Hiding by Invertible Network" (ICCV 2021)**
   - Junpeng Jing et al.
   - 가역(Invertible) 네트워크로 이미지에 비가시성 정보를 삽입/복원
   - 복원 가능한 비트/시크릿을 통해 워터마크 존재 여부 판별

---

## 🔬 분석 원리

### 1. HiNet 기반 워터마크 복원
```
이미지 → HiNet 역변환 (rev=True) → 숨겨진 정보 복원
```

**핵심 아이디어**:
- HiNet은 invertible network 구조
- 동일 네트워크로 **숨기기(삽입)**와 **복원(추출)** 수행
- 복원된 워터마크의 **Bit Error Rate(BER)**가 낮으면 워터마크 존재

### 2. MAIFS 적용 방식
- 입력 이미지를 256×256으로 리사이즈
- 역변환 결과에서 워터마크 채널을 추출
- BER 기반으로 워터마크 유무 판정

---

## 📊 메트릭 해석 가이드

### 1. has_watermark (워터마크 존재 여부)
**측정 방법**: 복원된 워터마크의 BER

**의미**:
- `True`: BER이 낮아 워터마크 복원 성공
- `False`: BER이 높아 워터마크 복원 실패

### 2. bit_error_rate (BER)
| 범위 | 의미 | 해석 |
|------|------|------|
| 0.0 - 0.1 | 매우 낮음 | 워터마크 확실 |
| 0.1 - 0.3 | 중간 | 워터마크 가능성 높음 |
| > 0.3 | 높음 | 워터마크 없음 또는 손상 |

---

## ⚖️ 분석의 강점과 한계

### 강점
✅ **명확한 복원 기반 판정**
   - 역변환으로 직접 워터마크 복원
   - BER로 정량적 판단 가능

✅ **스테가노그래피 워터마크에 적합**
   - HiNet 계열로 삽입된 워터마크에는 강함

### 한계
❌ **범용 워터마크 탐지 아님**
   - HiNet 방식으로 삽입된 워터마크에 한정
   - Diffusion 모델 워터마크(Stable Signature 등)와는 별개

❌ **강한 후처리에 취약**
   - 강한 JPEG 압축, 리사이즈, 필터링 시 BER 상승

---

## 🤝 다른 분석과의 관계

### vs Frequency/Noise
- Frequency/Noise는 **생성/촬영 흔적**을 분석
- Watermark(HiNet)는 **삽입된 워터마크의 직접 복원**

### vs Spatial
- Spatial은 **조작 위치**를 제공
- Watermark는 **삽입 여부**만 판단 (위치 정보 없음)

---

## 💡 해석 예시

### Case 1: 워터마크 복원 성공
```
has_watermark: True
bit_error_rate: 0.08
```

**해석**:
"HiNet 방식의 워터마크가 낮은 BER로 복원되었습니다.
이미지 내에 비가시성 워터마크가 존재하며, 무결성이 확인됩니다."

### Case 2: 워터마크 복원 실패
```
has_watermark: False
bit_error_rate: 0.42
```

**해석**:
"워터마크 복원이 실패했습니다. 워터마크가 없거나,
강한 후처리로 인해 손상되었을 가능성이 큽니다."

---

## 🔍 특수 케이스
